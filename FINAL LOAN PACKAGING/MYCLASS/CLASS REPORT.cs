using System;
using System.Data;
using System.Windows.Forms;
using CrystalDecisions.CrystalReports.Engine;
using CrystalDecisions.Windows.Forms;
using System.Globalization;

namespace FINAL_LOAN_PACKAGING.MYCLASS
{
    public class CLASS_REPORT
    {

        TextObject txt1;
        TextObject txt2;
        TextObject txt3;
        TextObject txt4;
        TextObject txt5;
        TextObject txt6;
        TextObject txt7;
        TextObject txt8;
        TextObject txt9;
        TextObject txt10;
        TextObject txt11;
        TextObject txt12;
        TextObject txt14;

        Form f;
        CrystalReportViewer cr;
        CrystalReport2 c;

        public static string invoice;
        public CLASS_REPORT()
        {
           
            f = new Form();
            cr = new CrystalReportViewer();
            f.WindowState = FormWindowState.Maximized;
            cr.ToolPanelView = ToolPanelViewType.None;
            cr.Dock = DockStyle.Fill;
            f.Controls.Add(cr);
            c = new CrystalReport2();
        }

        public void ViewInstallment(TextBox name, TextBox loanamount, TextBox term, ComboBox cmbterm, Label clientid, ComboBox baseno,
           TextBox intrate, MaskedTextBox maturitydate, MaskedTextBox loandate, ComboBox colateral, TextBox address, Label principal, Label interest,
           MaskedTextBox firsduedate, ComboBox principalpaymntmode, ComboBox interestpymntmode, ComboBox duedateoption, ComboBox diminishing, TextBox winterest
           , DataGridView dvg)
        {
           DateTime ld = DateTime.ParseExact(loandate.Text, "MM/dd/yyyy", CultureInfo.InvariantCulture);
            DateTime thismonth = new DateTime(ld.Year, ld.Month, 25);
            double totalprincipal;
            double.TryParse(principal.Text, out totalprincipal);

            #region BASENO
            if (baseno.Text == "STRAIGHT LINE")
            {
                // txt2.Text = baseno.Text + ":" + ' ' + principalpaymntmode.Text;
                if (duedateoption.Text == "DEFAULT")
                {
                    StraightlineDEF(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                        maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, dvg);
                }
                else if (duedateoption.Text == "END OF MNTH")
                {
                    StraightlineEOM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                        maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, dvg);
                }
                else if (duedateoption.Text == "15th/END OF EACH MNTH")
                {
                    Straightline15EOEM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                        maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest,dvg);
                }
                else if (duedateoption.Text == "SAME DAY OF EACH MNTH")
                {
                    StraightlineSDEM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                       maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, dvg);
                }
                else if (duedateoption.Text == "5th/20th OF EACH MNTH")
                {
                    Straightline520EOEM(duedateoption, baseno, cmbterm, term, principal, interest, firsduedate,
                        maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest,dvg);
                }
                else if (duedateoption.Text == "10th/25th OF EACH MNTH")
                {
                    Straightline1025EOEM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                         maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest,dvg);
                }
                else if (duedateoption.Text == "END OF WEEK(FRIDAY)")
                {

                }
                else if (duedateoption.Text == "15TH/30TH OF EACH MONTH")
                {
                    Straightline1530EOEM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                          maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest,dvg);
                }
                else if (duedateoption.Text == "25TH THIS MONTH")
                {
                    if (ld < thismonth)
                    {
                        Straightline25TM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                             maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, dvg);
                    }
                    else
                    {
                        Straightline25NM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                        maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, dvg);
                    }
                }
                else if (duedateoption.Text == "25TH NEXT MONTH")
                {
                    Straightline25NM(duedateoption, baseno, cmbterm, term, principal, interest, loandate,
                        maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, dvg);
                }
            }
            else if (baseno.Text == "DIMINISHING BAL")
            {
                //txt2.Text = baseno.Text + ":" + ' ' + diminishing.Text;
                if (duedateoption.Text == "DEFAULT")
                {
                    DiminishingDEF(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
                else if (duedateoption.Text == "END OF MNTH")
                {
                    DiminishingEOM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
                else if (duedateoption.Text == "15th/END OF EACH MNTH")
                {
                    Diminishing15EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                         loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "SAME DAY OF EACH MNTH")
                {
                    DiminishingSDEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
                else if (duedateoption.Text == "5th/20th OF EACH MNTH")
                {
                    Diminishing520EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "10th/25th OF EACH MNTH")
                {
                    Diminishing1025EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "END OF WEEK(FRIDAY)")
                {

                }
                else if (duedateoption.Text == "15TH/30TH OF EACH MONTH")
                {
                    Diminishing1530EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                       loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "25TH THIS MONTH")
                {
                    if (ld < thismonth)
                    {
                        Diminishing25TM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                            loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                    }
                    else
                    {
                        Diminishing25NM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                           loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                    }
                }
                else if (duedateoption.Text == "25TH NEXT MONTH")
                {
                    Diminishing25NM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                       loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
            }
            else if (baseno.Text == "ANNUITY")
            {
                //txt2.Text = baseno.Text + ":" + ' ' + diminishing.Text;
                if (duedateoption.Text == "DEFAULT")
                {
                    AnnuityDEFAULT(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
                else if (duedateoption.Text == "END OF MNTH")
                {
                    AnnuityEOM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                       loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
                else if (duedateoption.Text == "15th/END OF EACH MNTH")
                {
                    Annuity15EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                       loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "SAME DAY OF EACH MNTH")
                {
                    AnnuitySDEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                        loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
                else if (duedateoption.Text == "5th/20th OF EACH MNTH")
                {
                    Annuity520EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                       firsduedate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "10th/25th OF EACH MNTH")
                {
                    Annuity1025EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                      loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "END OF WEEK(FRIDAY)")
                {

                }
                else if (duedateoption.Text == "15TH/30TH OF EACH MONTH")
                {
                    Annuity1530EOEM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                       loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate,dvg);
                }
                else if (duedateoption.Text == "25TH THIS MONTH")
                {
                    if (ld < thismonth)
                    {
                        Annuity25TM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                             loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                    }
                    else
                    {
                        Annuity25NM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                            loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                    }
                }
                else if (duedateoption.Text == "25TH NEXT MONTH")
                {
                    Annuity25NM(diminishing, duedateoption, baseno, cmbterm, term, principal, interest,
                           loandate, maturitydate, principalpaymntmode, interestpymntmode, loanamount, winterest, intrate, dvg);
                }
            }
            #endregion
        }
        #region LOADREPORT
        public void showReport(string name, string loanamount, string term, string cmbterm, string DocNum, string baseno,
            string intrate, string maturitydate, string loandate, string colateral, string address, string principal, string interest,
            string firsduedate, string principalpaymntmode, string interestpymntmode, string duedateoption, string diminishing, string winterest, DataGridView dvg)
        {
            DataSet2 ds = new DataSet2();
            DataTable dt = ds.Tables.Add("Datatable1");
            
            txt1 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection2"].ReportObjects["BORROWERNAME"];
            txt2 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection11"].ReportObjects["INSTALLMENT"];
            txt3 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection11"].ReportObjects["FISRTDUEDATE"];
            txt4 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection10"].ReportObjects["LOANAMOUNT"];
            txt5 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection10"].ReportObjects["INTRATE"];
            txt6 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection10"].ReportObjects["dateofmaturity"];
            txt7 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection9"].ReportObjects["dateofloan"];
            txt8 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection9"].ReportObjects["TERM"];
            txt9 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection9"].ReportObjects["BCNUMBER"];
            txt10 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection11"].ReportObjects["COLATERAL"];
            txt11 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection3"].ReportObjects["Text16"];
            txt12 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection3"].ReportObjects["Text23"];
            txt14 = (TextObject)c.ReportDefinition.Sections["PageHeaderSection2"].ReportObjects["ADDRESS"];

            txt14.Text = address;
            txt12.Text = string.Format("{0:N2}", Convert.ToDouble(loanamount), 2);
            txt11.Text = loandate;
            txt10.Text = colateral;
            txt9.Text = DocNum;
            txt8.Text = term + ' ' + cmbterm;
            txt7.Text = loandate;
            txt4.Text = loanamount;
            txt5.Text = intrate +"%"+ ' ' + "p.a";
            txt6.Text = maturitydate;
            txt3.Text = firsduedate;
            txt1.Text = name;

        
            if (baseno == "STRAIGHT LINE")
            {
                txt2.Text = baseno + ":" + ' ' + principalpaymntmode;
            }
            else if (baseno == "DIMINISHING BAL")
            {
                txt2.Text = baseno + ":" + ' ' + diminishing;
            }
            else if (baseno == "ANNUITY")
            {
                txt2.Text = baseno + ":" + ' ' + diminishing;
            }
            dt.Columns.Add("installment");
            dt.Columns.Add("schedule");
            dt.Columns.Add("Days");
            dt.Columns.Add("principalamnt");
            dt.Columns.Add("Interest");
            dt.Columns.Add("amortization");
            dt.Columns.Add("principalbal");

            DataRow r;
            int i = 0;
            for ( i = 0; i < dvg.Rows.Count; i++)
			{
                r = dt.NewRow();
                r["installment"] = dvg.Rows[i].Cells[0].Value.ToString();
                r["schedule"] = dvg.Rows[i].Cells[1].Value.ToString();
                r["Days"] = dvg.Rows[i].Cells[2].Value.ToString();   
                r["principalamnt"] = dvg.Rows[i].Cells[3].Value.ToString();
                r["Interest"] = dvg.Rows[i].Cells[4].Value.ToString();
                r["amortization"] = dvg.Rows[i].Cells[5].Value.ToString();
                r["principalbal"] = dvg.Rows[i].Cells[6].Value.ToString();
                dt.Rows.Add(r);
 
			}
            
            //cr.ShowCloseButton = false ;
            c.SetDataSource(ds.Tables[1]);
            cr.ReportSource = c;
            cr.Refresh();
            //this.f.ControlBox = false;
            //this.cr.ShowPrintButton = false;
            f.ShowDialog();
          
        }
        #endregion
        ///ANNUITY 
        #region VIEWINSTALL
        #region ANNUITY DEFAULT
        public static void AnnuityDEFAULT(ComboBox Annuity, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization",Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double amort, loan, wint, rate, intdanty, intanty;
            double.TryParse(intrate.Text, out rate);
            string.Format("{{0:N2}}",double.TryParse(wholeinterest.Text, out wint));
            string.Format("{{0:N2}}", double.TryParse(principal.Text, out amort));
            string.Format("{{0:N2}}",  double.TryParse(loanamount.Text, out loan));
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no *2; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 15);
                        intdanty = ((loan * (rate / 100) / 360) * 15);
                        if (Annuity.Text == "S-MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);

                            }
                        }
                        else if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty; 
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 15);
                        intanty = ((iii * (rate / 100) / 360) * 15);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "S-MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {

                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);

                            }
                        }
                        else if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 6))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 3) % 24 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                        ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                       
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 15);
                        intdanty = ((loan * (rate / 100) / 360) * 15);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "S-MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {

                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);

                            }
                        }
                        else if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24;
                             ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 15);
                        intdanty = ((loan * (rate / 100) / 360) * 15);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "S-MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {

                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);

                            }
                        }
                        else if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 12 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 24 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        r["amortization"] = amort;
                        if (Annuity.Text == "MONTHLY")
                        {
                           
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                           
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] = intdanty;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    r["amortization"] = amort;
                                    iii -= (amort - intanty);
                                }
                            }
                          
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                    r["amortization"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    r["amortization"] = amort;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["Interest"] = intanty;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["amortization"] = amort;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    r["amortization"] = amort;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                    r["amortization"] = amort;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    r["amortization"] = amort;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["amortization"] = amort;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                                r["amortization"] = amort;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        r["amortization"] = amort;
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["amortization"] = amort;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                    r["amortization"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["amortization"] = amort;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                    r["amortization"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["amortization"] = amort;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 3))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["amortization"] = amort;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                    r["amortization"] = amort;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                    r["amortization"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                    r["amortization"] = amort;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                                r["amortization"] = amort;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                    r["amortization"] = amort;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    r["amortization"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                if ((no * 3) % 12 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6;
                        ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                             ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                               
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 3;
                       ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                       
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                               
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                               
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 4;
                       ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                               
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6;
                       ii = ii.AddDays(180), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = ii.AddDays(180) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) ;
                           ii = ii.AddDays(180), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(180);
                            r["schedule"] = date;
                            ts = ii.AddDays(180) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            r["amortization"] = amort + intanty;
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2)+1 ;
                          ii = ii.AddDays(180), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(180);
                            r["schedule"] = date;
                            ts = ii.AddDays(180) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;ii = ii.AddDays(180), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = ii.AddDays(180) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                             
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddDays(180), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = ii.AddDays(180) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 12;
                       ii = ii.AddDays(360), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = ii.AddDays(360) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 4;
                           ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            r["amortization"] = amort + intanty;
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4)+1;
                         ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m ==( no / 4)+1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2;
                           ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            r["amortization"] = amort + intanty;
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2)+1;
                          ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddDays(360), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = ii.AddDays(360) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        r["amortization"] = amort + intanty;
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                             //   iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
            
        }
        #endregion
        #region ANNUITY EOM
        public void AnnuityEOM(ComboBox Annuity, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double amort, loan, wint, rate, intdanty, intanty;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out amort);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 15);
                        intdanty = ((loan * (rate / 100) / 360) * 15);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 6))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 3) % 24 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                        ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24;
                             ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 12 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 24 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 3))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                if ((no * 3) % 12 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6;
                        ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                             ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 3;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);

                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 4;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6;
                       ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2);
                           ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;

                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 12;
                       ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 4;
                           ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4) + 1;
                         ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2;
                           ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //   iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY 15EOEM
        public void Annuity15EOEM(ComboBox Annuity, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double amort, loan, wint, rate, intdanty, intanty;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out amort);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 15);
                        intdanty = ((loan * (rate / 100) / 360) * 15);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 6))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 3) % 24 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                        ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24;
                             ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= (amort - intanty);
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= (amort - intanty);
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 12 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                if ((no * 24) % 24 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }

            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY SDEM
        public void AnnuitySDEM(ComboBox Annuity, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate , DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double amort, loan, wint, rate, intdanty, intanty;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out amort);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = ii;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        r["Amortization"] = amort;
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = (amort - intanty)  ;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 3))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                if ((no * 3) % 12 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6;
                        ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                             ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 3;
                       ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);

                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 4;
                       ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6;
                       ii = ii.AddMonths(6), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2);
                           ii = ii.AddMonths(6), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(6);
                            r["schedule"] = date;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(6), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(6);
                            r["schedule"] = date;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;

                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(6), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(6), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 12;
                       ii = ii.AddMonths(12), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "LMPSUM")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 4;
                           ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4) + 1;
                         ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2;
                           ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(12), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //   iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }


            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }

            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY 520EOEM
        public void Annuity520EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox fduedate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(fduedate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = ii;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY 1025EOEM
        public void Annuity1025EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY 1530EOEM
        public void Annuity1530EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY 25TM
        public void Annuity25TM(ComboBox Annuity, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double amort, loan, wint, rate, intdanty, intanty;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out amort);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);

            int no;
            int.TryParse(term.Text, out no);
             if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 3))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                if ((no * 3) % 12 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6;
                        ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                             ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 3;
                       ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);

                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 4;
                       ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6;
                       ii = ii.AddMonths(6), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2);
                           ii = ii.AddMonths(6), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(6), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;

                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(6), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(6), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 12;
                       ii = ii.AddMonths(12), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 4;
                           ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4) + 1;
                         ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2;
                           ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(12), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //   iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

             int RowCount = t.Rows.Count - 1;
             double _PricTotal = 0;
             double _PricAmount = 0;
             double _Balance = loan;
             foreach (DataRow Row in t.Rows)
             {


                 if ((int)Row[0] <= RowCount)
                 {
                     string _Value = Row[3].ToString();
                     _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                     _PricTotal = _PricTotal + _PricAmount;
                     _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                 }
                 else
                 {
                     Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                     string _Value = Row[3].ToString();
                     _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                 }

                 Row[6] = _Balance;
             }

             clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region ANNUITY 25NM
        public void Annuity25NM(ComboBox Annuity, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double amort, loan, wint, rate, intdanty, intanty;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out amort);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);

            int no;
            int.TryParse(term.Text, out no);
             if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;

                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == (no * 3))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - intanty;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                if ((no * 3) % 12 == 0)
                                {
                                    r["principalamnt"] = (amort + bal) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6;
                        ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - intanty;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= (amort - intanty);
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                if ((no * 6) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                             ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 30);
                        intdanty = ((loan * (rate / 100) / 360) * 30);
                        if (Annuity.Text == "MONTHLY")
                        {

                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                iii -= (amort - intanty);
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0;
                                r["principalamnt"] = (bal + amort) - amort;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                            }
                        }
                        else if (Annuity.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= (amort - intanty);
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 3 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 6 == 0)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                if ((no * 12) % 12 == 0)
                                {
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 3;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);

                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 3)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 4;
                       ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 90);
                        if (Annuity.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6;
                       ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 6)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2);
                           ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 180);
                            if (Annuity.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;

                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2;
                       ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 180);
                        if (Annuity.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;

                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 12;
                       ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= amort - intanty;
                                r["principalamnt"] = amort - intanty;
                                r["principalbal"] = balance;
                                r["Interest"] = intanty;
                                iii -= amort - intanty;
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no / 12)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 4;
                           ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 4)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4) + 1;
                         ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 4) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //  iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2;
                           ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                    //iii -= (amort - intanty);
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1;
                          ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            intanty = ((iii * (rate / 100) / 360) * 360);
                            if (Annuity.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + amort) - amort;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= amort - intanty;
                                        r["principalamnt"] = amort - intanty;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intanty;
                                        iii -= amort - intanty;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intanty;
                                    }
                                }
                            }
                            else if (Annuity.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 0;
                                    r["Interest"] = intanty;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= (amort - intanty);
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intanty;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                       ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        intanty = ((iii * (rate / 100) / 360) * 360);
                        if (Annuity.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + amort) - amort;
                                r["principalbal"] = 00;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= amort - intanty;
                                    r["principalamnt"] = amort - intanty;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intanty;
                                    iii -= amort - intanty;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intanty;
                                }
                            }
                        }
                        else if (Annuity.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 0;
                                r["Interest"] = intanty;
                            }
                            else
                            {
                                var balance = bal -= (amort - intanty);
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intanty;
                                //   iii -= (amort - intanty);
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

             int RowCount = t.Rows.Count - 1;
             double _PricTotal = 0;
             double _PricAmount = 0;
             double _Balance = loan;
             foreach (DataRow Row in t.Rows)
             {


                 if ((int)Row[0] <= RowCount)
                 {
                     string _Value = Row[3].ToString();
                     _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                     _PricTotal = _PricTotal + _PricAmount;
                     _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                 }
                 else
                 {
                     Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                     string _Value = Row[3].ToString();
                     _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                 }

                 Row[6] = _Balance;
             }
             clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        ///DIMINISHING
        #region DIMINISH DEFAULT
        public void DiminishingDEF(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "S-MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        r["amortization"] = prin + intpd;
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] =intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                     r["amortization"] = prin + intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance ;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                    r["amortization"] = intpd;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["amortization"] = prin + intpd;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no *2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] = intdims;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["amortization"] = prin + intpd;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                    r["amortization"] = intpd;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00; 
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["amortization"] = prin + intpd;
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["amortization"] = prin + intpd;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["amortization"] = prin + intpd;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] =  intpd ;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] = intdims;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;

                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["amortization"] = prin + intpd;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                iii -= prin;
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24;
                           ii = ii.AddDays(15), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "S-MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 8)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                   
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6== 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        r["amortization"] = prin;
                        if (Diminishing.Text == "MONTHLY")
                        {

                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                              
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                   
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["amortization"] = intpd;
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 3)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["amortization"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 3 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                        r["amortization"] = prin + intpd;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["amortization"] = prin + intpd;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        r["amortization"] = prin + intpd;
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] =  intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 3)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                    r["amortization"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                               // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                iii -= prin;
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                               // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                           ii = ii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = ii.AddDays(30) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                               // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3); ii = ii.AddDays(90), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(90);
                            r["schedule"] = date;
                            ts = ii.AddDays(90) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 3)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3)+1; ii = ii.AddDays(90), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(90);
                            r["schedule"] = date;
                            ts = ii.AddDays(90) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3)+1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 3)+1)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                        ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = bal.ToString();
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                             //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 4;
                      ii = ii.AddDays(90), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = ii.AddDays(90) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }

                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                             //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 6 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6; ii = ii.AddDays(180), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(180);
                            r["schedule"] = date;
                            ts = ii.AddDays(180) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 6)+1; ii = ii.AddDays(180), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(180);
                            r["schedule"] = date;
                            ts = ii.AddDays(180) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 6)+1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 6)+1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 6)+1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2; ii = ii.AddDays(180), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(180);
                            ts = ii.AddDays(180) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2 )+1; ii = ii.AddDays(180), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(180);
                            ts = ii.AddDays(180) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["schedule"] = due;
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no;
                      ii = ii.AddDays(180), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = ii.AddDays(180) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddDays(180), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = ii.AddDays(180) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //  iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 12 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12);
                            ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 12)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 12)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12)+1;
                           ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 12)+1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 12)+1)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4); ii = ii.AddDays(360), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = ii.AddDays(360) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == (no / 4))
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (bal + prin);
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no / 4)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                             //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2); ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal)- prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2)+1; ii = ii.AddDays(360), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = ii.AddDays(360) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] =(bal + prin)-prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2)+1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddDays(360), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = ii.AddDays(360) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = prin + bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                r["principalamnt"] = principal.Text;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                             //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }


            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH EOM
        public void DiminishingEOM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {

                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                               
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 3)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 3 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 3)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                iii -= prin;
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                           ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3); ii = ii.AddMonths(3), m++)
                        {
                            date = date.AddMonths(3);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 3)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3) + 1; ii = ii.AddMonths(3), m++)
                        {
                            date = date.AddMonths(3);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 3) + 1)
                                {

                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                        ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = bal.ToString();
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 4;
                      ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }

                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 6 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 6) + 1; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = lastDayOfMonth;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = lastDayOfMonth;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["schedule"] = due;
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no;
                      ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //  iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 12 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12);
                            ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 12)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 12)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12) + 1;
                           ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 12) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 12) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4); ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == (no / 4))
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (bal + prin);
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no / 4)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2); ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = lastDayOfMonth;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = prin + bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                r["principalamnt"] = principal.Text;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH 15EOEM
        public void Diminishing15EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no *2; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                      
                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance =bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] =balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                       
                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] =balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH SDEM
        public void DiminishingSDEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {

                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] =intdims;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["amortization"] = prin + intpd;
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 3)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                    r["amortization"] =  intpd;
                                }
                                else
                                {
                                    if (m % 3 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["amortization"] = prin + intpd;
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        r["amortization"] = prin + intpd;
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] = intdims;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 3)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] =intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                iii -= prin;
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] = intdims;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["amortization"] = intdims;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["amortization"] = intpd;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["amortization"] = prin + intpd;
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["amortization"] = prin + intpd;
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                           ii = ii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                    r["amortization"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["amortization"] = prin + intpd;
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["amortization"] = prin + intpd;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                                r["amortization"] = prin + intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = prin;
                                r["amortization"] = prin + intpd;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["amortization"] = prin + intpd;
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY") 
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3); ii = ii.AddMonths(3), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(3);
                            r["schedule"] = date;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    r["amortization"] = prin + intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["amortization"] = prin + intpd;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["amortization"] = prin + intpd;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                        r["amortization"] = prin + intpd;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 3)
                                {
                                    r["amortization"] = prin + intpd;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        r["amortization"] = prin + intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3) + 1; ii = ii.AddMonths(3), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(3);
                            r["schedule"] = date;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 3) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                        ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = bal.ToString();
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 4;
                      ii = ii.AddMonths(3), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }

                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 6 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6; ii = ii.AddMonths(6), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(6);
                            r["schedule"] = date;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 6) + 1; ii = ii.AddMonths(6), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(6);
                            r["schedule"] = date;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2; ii = ii.AddMonths(6), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(6);
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(6), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(6);
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["schedule"] = due;
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no;
                      ii = ii.AddMonths(6), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(6), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //  iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 12 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12);
                            ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 12)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 12)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12) + 1;
                           ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 12) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 12) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTRS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4); ii = ii.AddMonths(12), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == (no / 4))
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (bal + prin);
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no / 4)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2); ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(12), m++)
                        {
                            r = t.NewRow();
                            r["installment"] = m;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(12), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = prin + bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                r["principalamnt"] = principal.Text;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH 520EOEM
        public void Diminishing520EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH 1025EOEM
        public void Diminishing1025EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH 1530EOEM
        public void Diminishing1530EOEM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 2; ii = ii.AddDays(15), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddDays(15) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 2)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 2)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 2) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 6) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 12) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 24; ii = ii.AddMonths(1), m++)
                    {
                        DateTime now = DateTime.Now.AddDays(15);
                        DateTime sameday = new DateTime(now.Year, now.Month, 15);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 24)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 14)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();

                                        r["Interest"] = intpd;

                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 24)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == ((no * 24) - 1))
                            {
                                if (m % 4 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();

                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 6)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 6 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 24)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 24 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 24)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH 25TM
        public void Diminishing25TM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {

                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                               
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 3)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 3 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 3)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                iii -= prin;
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                           ii = ii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3); ii = ii.AddMonths(3), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 3)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3) + 1; ii = ii.AddMonths(3), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 3) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                        ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = bal.ToString();
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 4;
                      ii = ii.AddMonths(3), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }

                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 6 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6; ii = ii.AddMonths(6), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 6) + 1; ii = ii.AddMonths(6), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2; ii = ii.AddMonths(6), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(6), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["schedule"] = due;
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no;
                      ii = ii.AddMonths(6), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(6), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //  iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 12 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12);
                            ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 12)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 12)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12) + 1;
                           ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 12) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 12) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4); ii = ii.AddMonths(12), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == (no / 4))
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (bal + prin);
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no / 4)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2); ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(12), m++)
                        {
                            DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(12), m++)
                    {
                        DateTime sameday = new DateTime(ii.Year, ii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = prin + bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                r["principalamnt"] = principal.Text;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region DIMINISH 25NM
        public void Diminishing25NM(ComboBox Diminishing, ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, TextBox intrate, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            TimeSpan ts;
            double prin, interst, loan, wint, rate, intdims, intpd;
            double.TryParse(intrate.Text, out rate);
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double days = 0;

            int no;
            int.TryParse(term.Text, out no);
            if (cmbintmode.Text == "MONTHLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {

                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                               
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {

                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    r["principalamnt"] = 0;
                                    r["principalbal"] = 0;
                                    r["Interest"] = 0;
                                }
                            }
                            else if (m == (no - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin);
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 3)
                                {
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    r["principalamnt"] = 00;
                                }
                                else
                                {
                                    if (m % 3 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = balance;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["Interest"] = intpd;
                                        r["principalbal"] = bal;
                                    }
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    iii -= prin;
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 3; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);

                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 3)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 3)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = 00;
                                    r["Interest"] = 00;
                                }
                            }
                            else if (m == ((no * 3) - 1))
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = bal - bal;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 3)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 3)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 6; ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                iii -= prin;
                                var balance = bal -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 6)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 6)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 6)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 6)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no * 12;
                           ii = ii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(1) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        intdims = ((loan * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "MONTHLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB3")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 4)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "MONTHLY EMB6")
                        {
                            if (m == no * 12)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m < 7)
                                {
                                    r["principalamnt"] = 0.00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intdims;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;

                                }
                            }
                        }
                        else if (Diminishing.Text == "BIMONTHLY")
                        {
                            if (m == no * 12)
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = bal + prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    bal -= prin;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (prin + bal) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = bal;
                                }
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 12)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 12)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                // iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "QUARTERLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3); ii = ii.AddMonths(3), m++)
                        {
                            date = date.AddMonths(3);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 3)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 3)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 3) + 1; ii = ii.AddMonths(3), m++)
                        {
                            date = date.AddMonths(3);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(3) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "QUARTERLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["Interest"] = intpd;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                }
                            }
                            else if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 3) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 4 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal;
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 3) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    date = date.AddDays(30);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no;
                        ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (prin + bal) - prin;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = bal.ToString();
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = loan;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                ///iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 4;
                      ii = ii.AddMonths(3), m++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(3) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "QUARTERLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }

                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal;
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 4)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 4 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;

                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 4)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "SEMESTRAL")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 6 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 6; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 6)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 6) + 1; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);

                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 6) + 1)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    // iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no / 2; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(6), m++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            ts = ii.AddMonths(6) - ii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "SEMI ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (m % 2 == 0)
                                    {
                                        var balance = bal -= prin;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                        iii -= prin;
                                    }
                                    else
                                    {
                                        r["principalamnt"] = 0;
                                        r["principalbal"] = bal.ToString();
                                        r["Interest"] = intpd;
                                    }
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["schedule"] = due;
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //  iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {

                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no;
                      ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 0;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, bal = loan, iii = loan; m <= no * 2;
                      ii = ii.AddMonths(6), m++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(6) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "SEMI ANNUALLY")
                        {
                            if (m == no * 2)
                            {
                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = bal.ToString();
                                r["Interest"] = intpd;
                                iii -= prin;
                            }
                        }
                        else if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = (bal + prin) - prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                if (m % 2 == 0)
                                {
                                    var balance = bal -= prin;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                    iii -= prin;
                                }
                                else
                                {
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = bal.ToString();
                                    r["Interest"] = intpd;
                                }
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no * 2)
                            {

                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {

                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //  iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbintmode.Text == "YEARLY")
            {
                if (cmbterm.Text == "MONTHS")
                {
                    if (no % 12 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12);
                            ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == no / 12)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 12)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 12) + 1;
                           ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 12) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    iii -= prin;
                                    r["principalbal"] = balance;
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 12) + 1)
                                {

                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    var balance = bal -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                    //iii -= prin;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 4); ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == (no / 4))
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = (bal + prin);
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["principalamnt"] = principal.Text;
                                r["Interest"] = intpd;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no / 4)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2); ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2))
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (prin + bal) - prin;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == no / 2)
                                {
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= (no / 2) + 1; ii = ii.AddMonths(12), m++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            r["installment"] = m;
                            r["schedule"] = sameday;
                            ts = ii.AddMonths(12) - ii;
                            r["Days"] = ts.TotalDays;
                            days = Convert.ToInt32(ts.TotalDays);
                            intpd = ((iii * (rate / 100) / 360) * days);
                            if (Diminishing.Text == "ANNUALLY")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalbal"] = 0.00;
                                    r["principalamnt"] = (bal + prin) - prin;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["principalbal"] = bal.ToString();
                                    r["principalamnt"] = principal.Text;
                                    r["Interest"] = intpd;
                                }
                            }
                            else if (Diminishing.Text == "LUMPSUM")
                            {
                                if (m == (no / 2) + 1)
                                {
                                    r["principalamnt"] = loan;
                                    r["principalbal"] = 00;
                                    r["Interest"] = intpd;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = bal -= prin;
                                    //  iii -= prin;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                    r["Interest"] = intpd;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic m = 1, ii = date, iii = loan, bal = loan; m <= no; ii = ii.AddMonths(12), m++)
                    {
                        date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = ii.AddMonths(12) - ii;
                        r["Days"] = ts.TotalDays;
                        days = Convert.ToInt32(ts.TotalDays);
                        intpd = ((iii * (rate / 100) / 360) * days);
                        if (Diminishing.Text == "ANNUALLY")
                        {
                            if (m == no)
                            {
                                r["principalbal"] = 0.00;
                                r["principalamnt"] = prin + bal;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                iii -= prin;
                                r["principalbal"] = balance;
                                r["Interest"] = intpd;
                                r["principalamnt"] = principal.Text;
                            }
                        }
                        else if (Diminishing.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["principalamnt"] = prin;
                                r["principalbal"] = 00;
                                r["Interest"] = intpd;
                            }
                            else
                            {
                                var balance = bal -= prin;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                                r["Interest"] = intpd;
                                //   iii -= prin;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        ///STRAIGHT LINE 
        #region SL DEFAULT
        public void StraightlineDEF(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest , DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            DateTime FEOEM = new DateTime(date.Year, date.Month, 10);//
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);
            if (cmbterm.Text == "S-MONTHS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no / 2; iii = iii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = iii.AddDays(30) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= ((no) / 6); iii = iii.AddDays(90), q++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = iii.AddDays(90) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= ((no) / 12); iii = iii.AddDays(180), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = iii.AddDays(180) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddDays(360), y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = prin + ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVERY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddDays(360), ii -= prin, y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;
                        if (y == ((no) / 12))
                        {
                            r["Interest"] = (wint - sum) + interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = 0;
                        }
                        else
                        {
                            r["Interest"] = interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = loan;
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbterm.Text == "MONTHS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 2); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no; iii = iii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = iii.AddDays(30) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (ii + prin) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= no / 3; iii = iii.AddDays(90), q++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            date = date.AddDays(90);
                            ts = iii.AddDays(90) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= (no / 3)+1; iii = iii.AddDays(90), q++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            date = date.AddDays(90);
                            ts = iii.AddDays(90) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q ==( no / 3)+1)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == (no / 3)+1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                     r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == ( no / 3)+1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                     r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == (no / 3)+1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                     r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= (no / 6); iii = iii.AddDays(180), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = iii.AddDays(180) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no / 6)
                            {

                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= (no / 12); iii = iii.AddDays(360), y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == (no / 12))
                            {
                                r["Interest"] = (wint - sum) + interst; ////
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no / 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVERY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "QUARTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 6); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 3; iii = iii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = iii.AddDays(30) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 3))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= no; iii = iii.AddDays(90), q++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        date = date.AddDays(90);
                        ts = iii.AddDays(90) - iii;
                        r["schedule"] = date;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii)-prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2); iii = iii.AddDays(180), s++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            date = date.AddDays(180);
                            r["schedule"] = date;
                            ts = iii.AddDays(180) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2)+1; iii = iii.AddDays(180), s++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            date = date.AddDays(180);
                            r["schedule"] = date;
                            ts = iii.AddDays(180) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2)+1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                      date = date.AddDays(90);
                                      r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2)+1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2)+1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4); iii = date.AddDays(360), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = iii.AddDays(360) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4))
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4))
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4)+1; iii = date.AddDays(360), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = iii.AddDays(360) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4)+1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4)+1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "SEMESTRS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 12); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LEMPSUM")
                        {
                            if (sm == (no * 12))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 6; iii = iii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddDays(30);
                        r["schedule"] = date;
                        ts = iii.AddDays(30) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 6))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {

                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 2); iii = date.AddDays(90), q++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = iii.AddDays(90) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 2))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= no; iii = iii.AddDays(180), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = iii.AddDays(180) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii)-prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no)
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= no / 2; iii = iii.AddDays(360), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = iii.AddDays(360) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == no / 2)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == no / 2)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 2)+1; iii = iii.AddDays(360), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddDays(360);
                            r["schedule"] = date;
                            ts = iii.AddDays(360) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == (no / 2)+1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 2)+1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVERY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "YEARS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {

                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 24); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= (no * 12); iii = iii.AddDays(30), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddDays(30);
                        ts = iii.AddDays(30) - iii;
                        r["Days"] = ts.TotalDays;
                        r["schedule"] = date;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 4); iii = iii.AddDays(90), q++)
                    {
                        r = t.NewRow();
                        r["installment"] = q;
                        date = date.AddDays(90);
                        r["schedule"] = date;
                        ts = iii.AddDays(90) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= (no * 2); iii = iii.AddDays(180), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddDays(180);
                        r["schedule"] = date;
                        ts = iii.AddDays(180) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= no; iii = iii.AddDays(360), y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;

                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii)-prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVERY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL EOM
        public void StraightlineEOM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);
            if (cmbterm.Text == "S-MONTHS")
            {
               if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no / 2; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= ((no) / 6); iii = iii.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= ((no) / 12); iii = iii.AddMonths(6), s++)
                    {

                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddMonths(12), y++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = prin + ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVERY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM") /// lumpsum
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddDays(360), ii -= prin, y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;
                        if (y == ((no) / 12))
                        {
                            r["Interest"] = (wint - sum) + interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = 0;
                        }
                        else
                        {
                            r["Interest"] = interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = loan;
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbterm.Text == "MONTHS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 2); iii = iii.AddDays(15), sm++)
                    {

                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (ii + prin) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= no / 3; iii = iii.AddMonths(3), q++)
                        {
                            date = date.AddMonths(3);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date; 
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = lastDayOfMonth;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= (no / 3) + 1; iii = iii.AddMonths(3), q++)
                        {
                            date = date.AddMonths(3);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = lastDayOfMonth;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= (no / 6); iii = iii.AddMonths(6), s++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no / 6)
                            {

                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= (no / 12); iii = iii.AddMonths(12), y++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == (no / 12))
                            {
                                r["Interest"] = (wint - sum) + interst; ////
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no / 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVERY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "QUARTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 6); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 3; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 3))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= no; iii = iii.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        ts = iii.AddMonths(3) - iii;
                        r["schedule"] = lastDayOfMonth;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2); iii = iii.AddMonths(6), s++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            r["schedule"] = lastDayOfMonth;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2) + 1; iii = iii.AddMonths(6), s++)
                        {
                            date = date.AddMonths(6);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            r["schedule"] = lastDayOfMonth;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4); iii = date.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = lastDayOfMonth;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4))
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4))
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4) + 1; iii = date.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = lastDayOfMonth;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "SEMESTRS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 12); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 12))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 6; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 6))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {

                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 2); iii = date.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 2))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= no; iii = iii.AddMonths(6), s++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no)
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= no / 2; iii = iii.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = lastDayOfMonth;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == no / 2)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == no / 2)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 2) + 1; iii = iii.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                            var anydate = date;
                            var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = lastDayOfMonth;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 2) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "YEARS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {

                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 24); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= (no * 12); iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        r["schedule"] = date;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 4); iii = iii.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        r["installment"] = q;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= (no * 2); iii = iii.AddMonths(6), s++)
                    {
                        date = date.AddMonths(6);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= no; iii = iii.AddMonths(12), y++)
                    {
                        date = date.AddMonths(12);
                        var anydate = date;
                        var lastDayOfMonth = anydate.AddDays(1 - anydate.Day).AddMonths(1).AddDays(-1).Date;
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = lastDayOfMonth;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;

                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL 15EOEM
        public void Straightline15EOEM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);

            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no )
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 2; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 6; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 12; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 24; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL SDEM
        public void StraightlineSDEM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);
            if (cmbterm.Text == "S-MONTHS")
            {
                if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no / 2; iii = iii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= ((no) / 6); iii = iii.AddMonths(3), q++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= ((no) / 12); iii = iii.AddMonths(6), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddMonths(12), y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = prin + ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddMonths(12), ii -= prin, y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (y == ((no) / 12))
                        {
                            r["Interest"] = (wint - sum) + interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = 0;
                        }
                        else
                        {
                            r["Interest"] = interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = loan;
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbterm.Text == "MONTHS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 2); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no; iii = iii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (ii + prin) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= no / 3; iii = iii.AddMonths(3), q++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            date = date.AddMonths(3);
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= (no / 3) + 1; iii = iii.AddMonths(3), q++)
                        {

                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            date = date.AddMonths(3);
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = date;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= (no / 6); iii = iii.AddMonths(6), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no / 6)
                            {

                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= (no / 12); iii = iii.AddMonths(12), y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == (no / 12))
                            {
                                r["Interest"] = (wint - sum) + interst; ////
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no / 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "QUARTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 6); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 3; iii = iii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 3))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= no; iii = iii.AddMonths(3), q++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        date = date.AddMonths(3);
                        ts = iii.AddMonths(3) - iii;
                        r["schedule"] = date;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2); iii = iii.AddMonths(6), s++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            date = date.AddMonths(6);
                            r["schedule"] = date;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2) + 1; iii = iii.AddMonths(6), s++)
                        {

                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            date = date.AddMonths(6);
                            r["schedule"] = date;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4); iii = date.AddMonths(12), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4))
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4))
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4) + 1; iii = date.AddMonths(12), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "SEMESTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 12); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 12))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 6; iii = iii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        r["schedule"] = date;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 6))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {

                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 2); iii = date.AddMonths(3), q++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 2))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= no; iii = iii.AddMonths(6), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no)
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= no / 2; iii = iii.AddMonths(12), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == no / 2)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVERY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == no / 2)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 2) + 1; iii = iii.AddMonths(12), y++)
                        {
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            date = date.AddMonths(12);
                            r["schedule"] = date;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 2) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "YEARS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {

                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 24); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= (no * 12); iii = iii.AddMonths(1), m++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        date = date.AddMonths(1);
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        r["schedule"] = date;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 4); iii = iii.AddMonths(3), q++)
                    {
                        r = t.NewRow();
                        r["installment"] = q;
                        date = date.AddMonths(3);
                        r["schedule"] = date;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= (no * 2); iii = iii.AddMonths(6), s++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        date = date.AddMonths(6);
                        r["schedule"] = date;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= no; iii = iii.AddMonths(12), y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddMonths(12);
                        r["schedule"] = date;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;

                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL 520EOEM
        public void Straightline520EOEM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox fduedate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(fduedate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);

            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no;  sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        r["schedule"] = iii;
                        iii = iii.AddDays(15);
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 2; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = iii;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 6; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 12; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 24; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL 1025EOEM
        public void Straightline1025EOEM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);

            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 2; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 6; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 12; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 24; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL 1530EOEM
        public void Straightline1530EOEM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest,DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));


            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);

            if (cmbintmode.Text == "S-MONTHS")
            {
                if (cmbterm.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 2; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "QUARTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 6; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 6)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "SEMESTERS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 12; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbterm.Text == "YEARS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= no * 24; iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVERY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL 25TM
        public void Straightline25TM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);
            if (cmbterm.Text == "S-MONTHS")
            {
                 if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no / 2; iii = iii.AddMonths(1), m++)
                    {
                      
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= ((no) / 6); iii = iii.AddMonths(3), q++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= ((no) / 12); iii = iii.AddMonths(6), s++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddMonths(12), y++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = prin + ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddDays(360), ii -= prin, y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;
                        if (y == ((no) / 12))
                        {
                            r["Interest"] = (wint - sum) + interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = 0;
                        }
                        else
                        {
                            r["Interest"] = interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = loan;
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbterm.Text == "MONTHS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 2); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no; iii = iii.AddDays(30), m++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (ii + prin) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= no / 3; iii = iii.AddMonths(3), q++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= (no / 3) + 1; iii = iii.AddMonths(3), q++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= (no / 6); iii = iii.AddMonths(6), s++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no / 6)
                            {

                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= (no / 12); iii = iii.AddMonths(12), y++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == (no / 12))
                            {
                                r["Interest"] = (wint - sum) + interst; ////
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no / 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "QUARTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 6); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 3; iii = iii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 3))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= no; iii = iii.AddMonths(3), q++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        ts = iii.AddMonths(3) - iii;
                        r["schedule"] = sameday;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2); iii = iii.AddMonths(6), s++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2) + 1; iii = iii.AddMonths(6), s++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4); iii = date.AddMonths(12), y++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4))
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4))
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4) + 1; iii = date.AddMonths(12), y++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "SEMESTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 12); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 12))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 6; iii = iii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 6))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {

                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 2); iii = date.AddMonths(3), q++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 2))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= no; iii = iii.AddMonths(6), s++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no)
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= no / 2; iii = iii.AddMonths(12), y++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == no / 2)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == no / 2)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 2) + 1; iii = iii.AddMonths(12), y++)
                        {
                            DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 2) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "YEARS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {

                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 24); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= (no * 12); iii = iii.AddMonths(1), m++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        r["schedule"] = sameday;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 4); iii = iii.AddMonths(3), q++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        r["installment"] = q;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SMSTRAL")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= (no * 2); iii = iii.AddMonths(6), s++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= no; iii = iii.AddMonths(12), y++)
                    {
                        DateTime sameday = new DateTime(iii.Year, iii.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;

                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #region SL 25NM
        public void Straightline25NM(ComboBox duedateoption, ComboBox baseno, ComboBox cmbterm, TextBox term, Label principal, Label interest
        , MaskedTextBox loandate, MaskedTextBox duedate, ComboBox cmbprinmode, ComboBox cmbintmode, TextBox loanamount, TextBox wholeinterest, DataGridView dvg)
        {
            DataSet ds = new DataSet();
            DataTable t = ds.Tables.Add("Items");
            t.Columns.Add("Installment", Type.GetType("System.Int32"));
            t.Columns.Add("Schedule", Type.GetType("System.DateTime"));
            t.Columns.Add("Days", Type.GetType("System.Int32"));
            t.Columns.Add("Principalamnt", Type.GetType("System.Decimal"));
            t.Columns.Add("Interest", Type.GetType("System.Decimal"));
            t.Columns.Add("Amortization", Type.GetType("System.Decimal"));
            t.Columns.Add("Principalbal", Type.GetType("System.Decimal"));

            DataRow r;
            double prin, interst, loan, wint;
            double.TryParse(wholeinterest.Text, out wint);
            double.TryParse(principal.Text, out prin);
            double.TryParse(interest.Text, out interst);
            double.TryParse(loanamount.Text, out loan);
            DateTime date = Convert.ToDateTime(loandate.Text);
            DateTime due = Convert.ToDateTime(duedate.Text);
            double sum = 0.0;

            int no;
            TimeSpan ts;
            int.TryParse(term.Text, out no);
            if (cmbterm.Text == "S-MONTHS")
            {
                if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no / 2; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no / 2)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= ((no) / 6); iii = iii.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = balance;
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= ((no) / 12); iii = iii.AddMonths(6), s++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == ((no) / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddMonths(12), y++)
                    {
                        date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = prin + ii;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == ((no) / 12))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {
                    for (dynamic y = 1, iii = date, ii = loan - prin; y <= ((no) / 12); iii = date.AddDays(360), ii -= prin, y++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        date = date.AddDays(360);
                        r["schedule"] = date;
                        ts = iii.AddDays(360) - iii;
                        r["Days"] = ts.TotalDays;
                        if (y == ((no) / 12))
                        {
                            r["Interest"] = (wint - sum) + interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = 0;
                        }
                        else
                        {
                            r["Interest"] = interst;
                            r["principalamnt"] = principal.Text;
                            r["principalbal"] = loan;
                        }
                        t.Rows.Add(r);
                    }
                }
            }
            else if (cmbterm.Text == "MONTHS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 2); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 2))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (ii + prin) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    if (no % 3 == 0)
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= no / 3; iii = iii.AddMonths(3), q++)
                        {
                            date = date.AddMonths(3);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == no / 3)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic q = 1, iii = date, ii = loan; q <= (no / 3) + 1; iii = iii.AddMonths(3), q++)
                        {
                            date = date.AddMonths(3);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = q;
                            ts = iii.AddMonths(3) - iii;
                            r["Days"] = ts.TotalDays;
                            r["schedule"] = sameday;
                            if (cmbprinmode.Text == "QUARTERLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst; ////
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "SEMESTRAL")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 3 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (q % 6 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = balance;
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (q == (no / 3) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = prin;
                                    r["principalbal"] = 0;
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {

                    for (dynamic s = 1, iii = date, ii = loan; s <= (no / 6); iii = iii.AddMonths(6), s++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no / 6))
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no / 6)
                            {

                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= (no / 12); iii = iii.AddMonths(12), y++)
                    {
                        date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == (no / 12))
                            {
                                r["Interest"] = (wint - sum) + interst; ////
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no / 12)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "QUARTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 6); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 6))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 3; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 3)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 3))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= no; iii = iii.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        ts = iii.AddMonths(3) - iii;
                        r["schedule"] = sameday;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2); iii = iii.AddMonths(6), s++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2))
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic s = 1, iii = date, ii = loan; s <= (no / 2) + 1; iii = iii.AddMonths(6), s++)
                        {
                            date = date.AddMonths(6);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = s;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(6) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "SEMESTRAL")
                            {

                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "YEARLY")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    if (s % 2 == 0)
                                    {
                                        var balance = ii -= prin;
                                        r["Interest"] = interst;
                                        r["principalamnt"] = principal.Text;
                                        r["principalbal"] = ii.ToString();
                                    }
                                    else
                                    {
                                        r["Interest"] = interst;
                                        r["principalamnt"] = 00;
                                        r["principalbal"] = ii.ToString();
                                    }
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (s == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(90);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 4 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4); iii = date.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4))
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4))
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 4) + 1; iii = date.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                            DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {
                                if (y == (no / 4) + 1)
                                {
                                    r["Interest"] = (wint - sum) + interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                            else if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 4) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "SEMESTERS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {
                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 12); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == (no * 12))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= no * 6; iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(1)- iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == no * 6)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 6))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {

                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 2); iii = date.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = q;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(3) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                                r["schedule"] = due;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 2))
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= no; iii = iii.AddMonths(6), s++)
                    {
                        date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == no)
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {

                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    if (no % 2 == 0)
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= no / 2; iii = iii.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                           DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == no / 2)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == no / 2)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                    else
                    {
                        for (dynamic y = 1, iii = date, ii = loan; y <= (no / 2) + 1; iii = iii.AddMonths(12), y++)
                        {
                            date = date.AddMonths(12);
                           DateTime sameday = new DateTime(date.Year, date.Month, 25);
                            r = t.NewRow();
                            sum += interst;
                            r["installment"] = y;
                            r["schedule"] = sameday;
                            ts = iii.AddMonths(12) - iii;
                            r["Days"] = ts.TotalDays;
                            if (cmbprinmode.Text == "YEARLY")
                            {

                                if (y == (no / 2) + 1)
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = (prin + ii) - prin;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {
                                    ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = ii.ToString();
                                }
                            } if (cmbprinmode.Text == "EVRY NP")
                            {
                            }
                            else if (cmbprinmode.Text == "LUMPSUM")
                            {
                                if (y == (no / 2) + 1)
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = 0;
                                    date = date.AddDays(180);
                                    r["schedule"] = due;
                                }
                                else
                                {

                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    var balance = ii -= prin;
                                    r["principalbal"] = loan;
                                }
                            }
                            t.Rows.Add(r);
                        }
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }
            else if (cmbterm.Text == "YEARS")
            {
                if (cmbintmode.Text == "S-MONTHS")
                {

                    for (dynamic sm = 1, iii = date, ii = loan; sm <= (no * 24); iii = iii.AddDays(15), sm++)
                    {
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = sm;
                        date = date.AddDays(15);
                        r["schedule"] = date;
                        ts = iii.AddDays(15) - iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "S-MONTHS")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (sm == (no * 24))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (sm % 24 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 0;
                                    r["principalbal"] = ii.ToString();
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (sm == no * 24)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                var balance = ii -= prin;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "MONTHLY")
                {
                    for (dynamic m = 1, iii = date, ii = loan; m <= (no * 12); iii = iii.AddMonths(1), m++)
                    {
                        date = date.AddMonths(1);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = m;
                        ts = iii.AddMonths(1) - iii;
                        r["Days"] = ts.TotalDays;
                        r["schedule"] = sameday;
                        if (cmbprinmode.Text == "MONTHLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 3 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 6 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (m % 12 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (m == (no * 12))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "QUARTERLY")
                {
                    for (dynamic q = 1, iii = date, ii = loan; q <= (no * 4); iii = iii.AddMonths(3), q++)
                    {
                        date = date.AddMonths(3);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        r["installment"] = q;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(3)- iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "QUARTERLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;

                            }
                            else
                            {
                                if (q % 4 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (q == (no * 4))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "SEMESTRAL")
                {
                    for (dynamic s = 1, iii = date, ii = loan; s <= (no * 2); iii = iii.AddMonths(6), s++)
                    {
                         date = date.AddMonths(6);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = s;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(6)- iii;
                        r["Days"] = ts.TotalDays;
                        if (cmbprinmode.Text == "SEMESTRAL")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "YEARLY")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                if (s % 2 == 0)
                                {
                                    var balance = ii -= prin;
                                    r["Interest"] = interst;
                                    r["principalamnt"] = principal.Text;
                                    r["principalbal"] = balance;
                                }
                                else
                                {
                                    r["Interest"] = interst;
                                    r["principalamnt"] = 00;
                                    r["principalbal"] = ii;
                                }
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (s == (no * 2))
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "YEARLY")
                {
                    for (dynamic y = 1, iii = date, ii = loan; y <= no; iii = iii.AddMonths(12), y++)
                    {
                         date = date.AddMonths(12);
                        DateTime sameday = new DateTime(date.Year, date.Month, 25);
                        r = t.NewRow();
                        sum += interst;
                        r["installment"] = y;
                        r["schedule"] = sameday;
                        ts = iii.AddMonths(12) - iii;
                        r["Days"] = ts.TotalDays;

                        if (cmbprinmode.Text == "YEARLY")
                        {
                            if (y == no)
                            {
                                r["Interest"] = (wint - sum) + interst;
                                r["principalamnt"] = (prin + ii) - prin;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = ii.ToString();
                            }
                        }
                        else if (cmbprinmode.Text == "EVRY NP")
                        {
                        }
                        else if (cmbprinmode.Text == "LUMPSUM")
                        {
                            if (y == no)
                            {
                                r["Interest"] = interst;
                                r["principalamnt"] = principal.Text;
                                r["principalbal"] = 0;
                            }
                            else
                            {
                                var balance = ii -= prin;
                                r["Interest"] = interst;
                                r["principalamnt"] = 00;
                                r["principalbal"] = loan;
                            }
                        }
                        t.Rows.Add(r);
                    }
                }
                else if (cmbintmode.Text == "EVRY NP")
                {

                }
                else if (cmbintmode.Text == "LUMPSUM")
                {

                }
            }

            int RowCount = t.Rows.Count - 1;
            double _PricTotal = 0;
            double _PricAmount = 0;
            double _Balance = loan;
            foreach (DataRow Row in t.Rows)
            {


                if ((int)Row[0] <= RowCount)
                {
                    string _Value = Row[3].ToString();
                    _PricAmount = double.Parse(double.Parse(_Value).ToString("N2"));
                    _PricTotal = _PricTotal + _PricAmount;
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }
                else
                {
                    Row[3] = loan - double.Parse(_PricTotal.ToString("N2"));

                    string _Value = Row[3].ToString();
                    _Balance = _Balance - double.Parse(double.Parse(_Value).ToString("N2"));
                }

                Row[6] = _Balance;
            }
            clsFunctions.DataGridViewSetup(dvg, t, "Amortization");
        }
        #endregion
        #endregion
    }
}
